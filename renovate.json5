{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:base"],

  "gitIgnoredAuthors": [
    "githubaction@githubaction.com"
  ],

  "rebaseWhen": "never",
  "prCreation": "immediate",

  /*
   * =========================
   * Docker 全局能力
   * =========================
   */
  "docker": {
    "enabled": true,
    "registryUrls": [
      "https://docker.io",
      "https://ghcr.io"
    ]
  },

  "packageRules": [
    /*
     * =========================
     * 非 Docker 规则（保持原样）
     * =========================
     */
    {
      "packageNames": ["docker-compose"],
      "automerge": true
    },

    /*
     * =========================
     * Registry 维度控制（来源）
     * =========================
     */

    {
      "matchDatasources": ["docker"],
      "matchPackagePatterns": ["^ghcr\\.io/"],
      "enabled": false
    },
    {
      "matchDatasources": ["docker"],
      "matchPackageNames": ["ghcr.io/sagernet/sing-box"],
      "enabled": true
    },

    /*
     * =========================
     * sing-box 版本策略（完全独立）
     * =========================
     */

    {
      "matchDatasources": ["docker"],
      "matchPackageNames": ["ghcr.io/sagernet/sing-box"],
      "allowedVersions": "/^v?\\d+\\.\\d+\\.\\d+$/"
    },
    {
      "matchDatasources": ["docker"],
      "matchPackageNames": ["ghcr.io/sagernet/sing-box"],
      "allowedVersions": "/^v?\\d+\\.\\d+\\.\\d+-(alpha|beta|rc)\\.\\d+$/",
      "prerelease": true
    }
  ]
}
